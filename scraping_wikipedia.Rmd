---
title: "Scraping Wikipedia"
output: html_notebook
---

Get species common name from wikipedia
```{r scrape wikipedia to get species names}
#scrape wikipedia to get common name for all of these species

library(rvest)
library(tidyverse)

get_url <- function(x,y) { #function to try two links, pick one that works
    
  infobox <- try(
    x %>%
    read_html() %>%
    html_nodes("p") %>%
      html_text())
  if(class(infobox) == "try-error") { infobox <- try(
    y %>%
    read_html() %>%
    html_nodes("p") %>%
    html_text())
  if(class(infobox) == "try-error") {infobox <- NA}
  }
  infobox
  }

speciesnames <- as.data.table(matrix(nrow = length(inverts)))
speciesnames[, inverts :=as.character(inverts)][,wiki:=as.character(V1)][, V1 := NULL]


for (i in 1:length(inverts)) {
  genus <- word(inverts[i])
  
    url1 <- paste0("https://en.wikipedia.org/wiki/", genus, "_(genus)") #url with genus
    url2 <- paste0("https://en.wikipedia.org/wiki/", genus) #url without genus
  
  infobox <- get_url(url1,url2)
  
  pattern = "genus(.*?)\\." #escape backspace, and then escape period
  
  text <- ifelse(is.na(infobox[1]), NA, regmatches(infobox, regexpr(pattern, infobox)))

  speciesnames[i, wiki := paste0(text)]
  
}

#this gave me list of inverts, and whether they are actually inverts or fish

#export to excel to make edits

write.csv(speciesnames, file = "invert_yes_no.csv")

```