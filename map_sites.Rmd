---
title: "Map of Sites"
output: html_notebook
---

```{r setup}
library(data.table)
library(mapdata)
library(maps)
library(plyr)

load("hauls_catch_Dec2017 1.RData")

```

```{r extract unique GPS points}
hauls <- data.table(hauls)

hauls2 <- hauls[region == "NEFSC_NEUS" & year < 1982, ':=' (lat = NA, lon = NA)]

gpspointsonly <- hauls2[, .(region, lat, lon)]
gpspointsonly[, lat := round_any(lat, 0.5)][, lon := round_any(lon, 0.5)][, region := as.factor(region)]
gpspointsonly <- unique(gpspointsonly[,.(region, lat, lon)])

gpspointsonly <- gpspointsonly[region != "DFO_SoGulf" & region != "NWFSC_WCAnn" & region != "VIMS_NEAMAP"] #taking away neus to add neus points back after taking away years before 1982


#rename factors
key <- data.table(region = levels(gpspointsonly[,as.factor(region)]), Regions = c("Aleutian Islands", "Eastern Bering Sea", "Gulf of Alaska", "West Coast Triennial", "Newfoundland", "Scotian Shelf", NA, "Northeast US", NA, "Southeast US", "Gulf of Mexico", NA))

gpspointsonly <- gpspointsonly[key, on = "region"]

```

```{r set up map}
world <- data.table(map_data('world'))

north_america <- world[long >= -250 & long <= -30 & lat >= 20 & lat <= 80]

NAmap <- ggplot() + geom_polygon(data = north_america, 
                                 aes(x=long, y = lat, group = group), 
                                 fill = "white", 
                                 color="black") +
    coord_fixed(xlim = c(-200, -40),  ylim = c(25, 65), ratio = 1.3)

```
Add points and polygons
```{r add points}


NAplot_polygons <- ggplot() + geom_polygon(data = north_america, 
                                 aes(x=long, y = lat, group = group), 
                                 fill = "white", 
                                 color="black", size = 0.02) +
            coord_fixed(xlim = c(-190, -40),  ylim = c(25, 65), ratio = 1.3) + 
            geom_point(data = gpspointsonly[!is.na(Regions)], aes(x=lon, y = lat, color = Regions), size = 0.001) +
            guides(color = guide_legend(override.aes = list(size = 1))) +
            geom_jitter() +
            theme_bw() +
            labs(x=paste0("Longitude (", "\u00b0", "E)"), y = paste0("Latitude (", "\u00b0", "N)"))+
            theme(panel.grid = element_blank())

ggsave(plot = NAplot_polygons, file = "NAplot_polygons.eps")

```













```{r}
library(PerformanceAnalytics)
mydata <- spp_master_ztemp[,.(max_sst_temp, max_sbt_temp, min_sst_temp, max_sst_temp, mean_sst_temp, mean_sbt_temp)]
chart.Correlation(mydata, histogram = T, pch = 19)

cor(spp_master_ztemp$min_sst_temp, spp_master_ztemp$mean_sst_temp)

```


